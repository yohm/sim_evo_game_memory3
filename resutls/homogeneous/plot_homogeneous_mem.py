# %%
import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl
mpl.rcParams.update(mpl.rcParamsDefault)

#%%
plt.rcParams['font.family'] ='sans-serif'
plt.rcParams["figure.subplot.left"] = 0.2
plt.rcParams["figure.subplot.right"] = 0.95
plt.rcParams["figure.subplot.bottom"] = 0.20
plt.rcParams["figure.subplot.top"] = 0.95
plt.rcParams['xtick.direction'] = 'in'
plt.rcParams['ytick.direction'] = 'in'
plt.rcParams['xtick.major.width'] = 1.0
plt.rcParams['ytick.major.width'] = 1.0
plt.rcParams['axes.labelsize'] =18
plt.rcParams['font.size'] = 16
plt.rcParams['axes.linewidth'] = 1.2
mpl.rcParams['lines.markersize'] = 6
plt.rcParams['savefig.dpi'] = 200
plt.rcParams['figure.facecolor'] = 'white'
plt.rcParams["errorbar.capsize"] = 2
plt.rcParams['lines.marker'] = 'o'
plt.rcParams['lines.linestyle'] = '-'
cmap = plt.rcParams['axes.prop_cycle'].by_key()['color']

# %%
def set_axis():
  plt.clf()
  fig1, ax1 = plt.subplots()
  ax1.set_xscale("log")
  ax1.set_ylim(-0.02, 3.02)
  ax1.set_yticks([0, 1.5, 3])
  ax1.set_yticks([0.5,1,2,2.5], minor=True)
  ax1.set_xlim(1.8, 70)
  ax1.set_xlabel("population size, $N$")
  xlabels = [2, 4, 8, 16, 32, 64]
  ax1.set_xticks(xlabels)
  ax1.get_xaxis().set_major_formatter(mpl.ticker.ScalarFormatter())
  return fig1, ax1


# %%
# http://localhost:3333/parameter_sets/631049f27a3aca027357d161?plot_type=line&x_axis=N&y_axis=.mem_length_self&series=benefit&irrelevants=#!tab-plot
# http://localhost:3333/parameter_sets/631049f27a3aca027357d161?plot_type=line&x_axis=N&y_axis=.mem_length_opponent&series=benefit&irrelevants=#!tab-plot

fig1, ax1 = set_axis()
ax1.set_ylabel("memory length")

ax1.plot([], [], color='gray', label=r"$m_1$", marker='^', linestyle='solid')
ax1.plot([], [], color='gray', label=r"$m_2$", marker='v', linestyle='dashed')
ax1.plot([1, 100], [1.5, 1.5], color='gray', linestyle='dotted')

# m1
# benefit = 6.0
label = r'$m_1, b=6$'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [1.2793111992346657, 1.3182410202678003, 1.4075602306224786, 1.5834162037957822, 1.663769404188227, 1.795744217493575, 1.863829293143659, 1.8823413137125709, 1.945693939659933, 1.9695784106426786, 1.9621757357508176]
yerr = [0.001398579371705277, 0.0013520898652020735, 0.004251424758653434, 0.00688443624725391, 0.019541899986349025, 0.01887883064897181, 0.016685878018368388, 0.029772914669023317, 0.024540770182749024, 0.05852072697280502, 0.04177711320367942]
ax1.errorbar(x, y, yerr=yerr, color=cmap[0], marker='^')

# benefit = 3.0
label = r'$m_1, b=3$'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [1.2800444222715803, 1.307937453263837, 1.3274020304467005, 1.4040406711563014, 1.4963081070090078, 1.5827408697120775, 1.6302608114009014, 1.6746156384618207, 1.8061343401492667, 1.7466424962694405, 1.7954174393527105]
yerr = [0.0008557187011848846, 0.001093218477423983, 0.0011662539354961403, 0.003593186180779311, 0.008189096693612822, 0.014112986892027573, 0.013873424991905246, 0.03529608945260968, 0.04747694250339822, 0.029348517586707628, 0.03837071223379066]

ax1.errorbar(x, y, yerr=yerr, color=cmap[1], marker='^')

# benefit = 1.5
label = r'$m_1, b=1.5$'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [1.278938198820221, 1.3011527790586435, 1.2962765514183905, 1.2987692208546897, 1.292343991493324, 1.2925645472939415, 1.2858604287338098, 1.2781107534563927, 1.271543523937249, 1.27875964306627, 1.2605587339541489]
yerr = [0.0006378022406694731, 0.0007998867654183613, 0.0010794009995283268, 0.001212012157611387, 0.001473156012592649, 0.0023959111990695947, 0.0020870178595571625, 0.002316740845847477, 0.0032660071369930875, 0.01923450950855169, 0.012115340573635986]

ax1.errorbar(x, y, yerr=yerr, color=cmap[2], marker='^')


# m2
# benefit = 6.0
label = r'$b=6$, $m_2$'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [1.2352092613436239, 1.275153861282068, 1.3619178465753852, 1.5552172835747595, 1.6132236813596461, 1.7432031591146213, 1.8090933434370484, 1.8038445598272888, 1.8771961968846633, 1.9210791345323717, 1.847460052733392]
yerr = [0.001398339323033652, 0.0010262154572496078, 0.00495300198327386, 0.009995133611681842, 0.016971925865779097, 0.02164007533104619, 0.017992215089193724, 0.027746867432030718, 0.03686468855802951, 0.062458634536029865, 0.03784350283378052]

ax1.errorbar(x, y, yerr=yerr, color=cmap[0], marker='v', linestyle='dashed')

# benefit = 3.0
label = r'$b=3$, $m_2$'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [1.2379197087996765, 1.2622858469842746, 1.2812816458684955, 1.35207639119599, 1.4437916042128935, 1.5417254908061009, 1.584892427658253, 1.6211280234755818, 1.7597780664200737, 1.6966912185457985, 1.7477782753091948]
yerr = [0.0008154496535600295, 0.0011966037442253362, 0.0014943969581796951, 0.0033878184177053524, 0.00820225745538963, 0.015620758439795046, 0.013428922127390552, 0.03674524738542186, 0.05119745150299525, 0.028606122764610685, 0.036466558967420674]

ax1.errorbar(x, y, yerr=yerr, color=cmap[1], marker='v', linestyle='dashed')

# benefit = 1.5
label = r'$b=1.5$, $m_2$'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [1.2345602606225117, 1.2584960649956278, 1.2482289424766029, 1.2372572636191819, 1.2256802507558342, 1.2120321244801384, 1.1941732157480174, 1.1659082954536617, 1.150251500279445, 1.1396022662247405, 1.1082402313780348]
yerr = [0.001831692380211516, 0.0011296792359459223, 0.001287672426212482, 0.0009840118532493866, 0.0015361395964348826, 0.005758784994880449, 0.0024504500828560656, 0.002877890478334148, 0.004519907317213369, 0.0218078675428616, 0.01071202874635567]

ax1.errorbar(x, y, yerr=yerr, color=cmap[2], marker='v', linestyle='dashed')

ax1.text(28, 2.1, r'$b=6$', color=cmap[0])
ax1.text(28, 1.51, r'$b=3$', color=cmap[1])
ax1.text(28, 0.9, r'$b=1.5$', color=cmap[2])

plt.legend(loc='upper left')
fig1.savefig('memory_homogeneous_m3.pdf')
plt.show()
# %%

# http://localhost:3333/parameter_sets/631054e57a3aca027357d2a8?plot_type=line&x_axis=N&y_axis=.mem_length_self&series=benefit&irrelevants=#!tab-plot
# http://localhost:3333/parameter_sets/631054e57a3aca027357d2a8?plot_type=line&x_axis=N&y_axis=.mem_length_opponent&series=benefit&irrelevants=#!tab-plot

fig1, ax1 = set_axis()
ax1.set_ylim(-0.05, 1.05)
ax1.set_yticks([0, 0.5, 1])
ax1.set_ylabel("memory length")

ax1.plot([], [], color='gray', label=r"$m_1$", marker='^', linestyle='solid')
ax1.plot([], [], color='gray', label=r"$m_2$", marker='v', linestyle='dashed')
ax1.plot([1, 100], [0.5, 0.5], color='gray', linestyle='dotted')

# m_1
# benefit = 6.0
label = 'benefit=6.0'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [0.3177651308501454, 0.3393914882127647, 0.3855260950289945, 0.9699071887857654, 0.9996302218113577, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
yerr = [0.0005825297825049217, 0.00045915193120009526, 0.00035843991550731324, 0.0005275543072844774, 4.665784016781674e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

ax1.errorbar(x, y, yerr=yerr, color=cmap[0], marker='^')

# benefit = 3.0
label = 'benefit=3.0'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [0.31791935324372583, 0.34001493334992594, 0.3347483719426355, 0.3484460538289487, 0.5310537011707791, 0.9762473069414522, 0.9991477768308632, 1.0, 1.0, 1.0, 1.0]
yerr = [0.00048676659558800873, 0.00040138431582943684, 0.0005082592396775059, 0.0005081958289170196, 0.0009831197101917912, 0.0007413632702370295, 9.906044135114716e-05, 0.0, 0.0, 0.0, 0.0]

ax1.errorbar(x, np.array(y)-0.005, yerr=yerr, color=cmap[1], marker='^')

# benefit = 1.5
label = 'benefit=1.5'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [0.3174762416402685, 0.33964726627474034, 0.3353192614658461, 0.3282440313822571, 0.32213858015397795, 0.31221412468236076, 0.30471900524333917, 0.2945472161635735, 0.28599631777368645, 0.27417508241675825, 0.26733729704144116]
yerr = [0.00048394719129928325, 0.0002637222961294785, 0.00048125293036535875, 0.0006287958766456017, 0.0006033740906339948, 0.0005074459584603603, 0.00044933723955038545, 0.0009710917898555554, 0.0004600752412117984, 0.000734770230518924, 0.0006787498264723954]

ax1.errorbar(x, y, yerr=yerr, color=cmap[2], marker='^')

# m_2
# benefit = 6.0
label = 'benefit=6.0'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [0.3956314395904884, 0.41331579257310286, 0.45991728879698757, 0.9737528597253997, 0.999683332981481, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
yerr = [0.0005371079344627309, 0.0006088604307053117, 0.00039045851837593906, 0.00046635544640982583, 4.2472018409660273e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
ax1.errorbar(x, y, yerr=yerr, color=cmap[0], marker='v', linestyle='dashed')

# benefit = 3.0
label = 'benefit=3.0'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [0.39623099581221755, 0.41296890329878144, 0.41583979537755045, 0.43489692766325294, 0.5951952168835744, 0.9794926438807154, 0.9992773325303694, 1.0, 1.0, 1.0, 1.0]
yerr = [0.0004938847437725821, 0.0004686266889778899, 0.000564882352888049, 0.0005894969362187203, 0.0008137579355851418, 0.0006592658635702058, 8.791937739966154e-05, 0.0, 0.0, 0.0, 0.0]

ax1.errorbar(x, np.array(y)-0.005, yerr=yerr, color=cmap[1], marker='v', linestyle='dashed')

# benefit = 1.5
label = 'benefit=1.5'
x = [2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64]
y = [0.39573743970826636, 0.4129855699839666, 0.4162013513348349, 0.4179601310668123, 0.41604935116594577, 0.4084134537927264, 0.40133233481370534, 0.38903076558973954, 0.37766608629565146, 0.36074173415748245, 0.34936216595796216]
yerr = [0.0004950803485644182, 0.00037045470581736515, 0.0004025249499894184, 0.0006959913691418907, 0.0006057109035680387, 0.00040234109703454453, 0.00048108883697082393, 0.0009219802583651933, 0.0006887281945594046, 0.0006812716745167501, 0.0005694243348156702]

ax1.errorbar(x, y, yerr=yerr, color=cmap[2], marker='v', linestyle='dashed')

ax1.text(3.6, 0.95, r'$b=6$', color=cmap[0])
ax1.text(24, 0.92, r'$b=3$', color=cmap[1])
ax1.text(24, 0.42, r'$b=1.5$', color=cmap[2])

ax1.legend(loc='lower right')
fig1.savefig('memory_homogeneous_m1.pdf')
plt.show()
# %%
